# pfQuest 数据库 (`/db`) 文件格式说明

`pfQuest` 插件的核心是一个结构化、紧凑的数据库，用于存储游戏中的各种实体信息。为了提高性能和减少内存占用，数据库文件（主要位于 `pfQuest/db` 目录下）采用了缩写字段名。本文档旨在解释这些核心字段的含义。

## 任务数据库 (`quests.lua`)

任务数据是数据库中最核心的部分之一，其结构如下：

```lua
pfDB["quests"]["zhCN"] = {
  [2] = {
    ["D"] = "强大的角鹰兽沙普塔隆已经被你杀死了...",
    ["O"] = "将沙普塔隆的爪子交给灰谷碎木哨岗的塞娜尼·雷心。",
    ["T"] = "沙普塔隆的爪子",
  },
  -- ... 更多任务条目
}
```

### 字段含义

-   `[任务ID]`: 数组的键是一个整数，代表了该任务在游戏中的唯一ID。例如，`[2]` 代表任务ID为2。

-   **`T`**: **Title (标题)**
    -   **含义**: 任务的名称。这是玩家在任务日志（Quest Log）和NPC对话框中看到的任务标题。
    -   **示例**: `"沙普塔隆的爪子"`

-   **`O`**: **Objective (目标)**
    -   **含义**: 任务的目标描述。这部分文本通常会简明扼要地告诉玩家需要完成什么，例如“杀死10只狼”或“将物品A交给NPC B”。
    -   **示例**: `"将沙普塔隆的爪子交给灰谷碎木哨岗的塞娜尼·雷心。"`

-   **`D`**: **Description (描述)**
    -   **含义**: 任务的详细描述。这是玩家从NPC处接取任务时看到的背景故事和详细说明，通常包含更多的情节和上下文信息。
    -   **示例**: `"强大的角鹰兽沙普塔隆已经被你杀死了，它的爪子将成为你胜利的象征...。"`

### 特殊字符

在任务文本中，可能会出现一些特殊的占位符，它们会在游戏中被动态替换：

-   `$N`: 玩家的名字 (Player's Name)
-   `$C`: 玩家的职业 (Player's Class)
-   `$R`: 玩家的种族 (Player's Race)
-   `$B`: 换行符 (Line Break)
-   `$g<男性称呼>:<女性称呼>;`: 根据玩家性别显示不同的称呼。例如 `$g兄弟:姐妹;` 会根据玩家性别显示为“兄弟”或“姐妹”。

---

## 其它数据库文件

`pfQuest` 还包含其它类型的数据库文件，如 `items.lua` (物品), `units.lua` (单位/NPC), `objects.lua` (游戏对象) 等。虽然它们的结构可能更复杂，但同样遵循了使用缩写字段来优化性能的设计哲学。通过交叉引用 `database.lua` 和 `quest.lua` 等核心逻辑文件，可以进一步解析这些文件的具体结构和字段含义。
