# pfQuest æ•°æ®å¤„ç†å·¥å…·é›†

è¿™æ˜¯ä¸€ä¸ªå®Œæ•´çš„ pfQuest æ’ä»¶æ•°æ®å¤„ç†å·¥å…·é›†ï¼ŒåŒ…å«æ•°æ®åˆå¹¶å’Œä»»åŠ¡å¥–åŠ±æŠ“å–åŠŸèƒ½ã€‚

## ğŸ› ï¸ å·¥å…·æ¦‚è§ˆ

### 1. ä»»åŠ¡æ•°æ®åˆå¹¶å·¥å…·
- **æ–‡ä»¶**: `index.js`, `quest-merger.js`, `lua-parser.js`
- **åŠŸèƒ½**: åˆå¹¶åŸºç¡€ä»»åŠ¡æ•°æ®å’Œä¹Œé¾Ÿæœæ•°æ®ï¼Œç”Ÿæˆæœ‰æ•ˆä»»åŠ¡IDåˆ—è¡¨
- **è¾“å‡º**: `output/valid-quest-ids.json`

### 2. ä»»åŠ¡å¥–åŠ±æŠ“å–å·¥å…· (Selenium)
- **æ–‡ä»¶**: `scrape-quest-rewards-selenium.js`, `quest-reward-scraper-selenium.js`
- **åŠŸèƒ½**: ä½¿ç”¨çœŸå®æµè§ˆå™¨æŠ“å–ä»»åŠ¡å¥–åŠ±å’Œç‰©å“ä¿¡æ¯
- **è¾“å‡º**: `output/quest-rewards-selenium.json`

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å®‰è£…ä¾èµ–
```bash
cd Tools
npm install
```

### åŸºæœ¬ä½¿ç”¨æµç¨‹

#### æ­¥éª¤1: åˆå¹¶ä»»åŠ¡æ•°æ®
```bash
# ç”Ÿæˆæœ‰æ•ˆä»»åŠ¡IDåˆ—è¡¨
npm start
# æˆ–
npm run merge
```

#### æ­¥éª¤2: æŠ“å–ä»»åŠ¡å¥–åŠ±
```bash
# è°ƒè¯•å•ä¸ªä»»åŠ¡ï¼ˆæ¨èé¦–æ¬¡ä½¿ç”¨ï¼‰
npm run scrape-debug

# å¤„ç†å°‘é‡ä»»åŠ¡
npm run scrape-sample

# åå°æ‰¹é‡å¤„ç†
npm run scrape-headless

# å¤„ç†æ‰€æœ‰ä»»åŠ¡ï¼ˆæ—¶é—´è¾ƒé•¿ï¼‰
npm run scrape
```

## ğŸ“‹ è¯¦ç»†ä½¿ç”¨è¯´æ˜

### ä»»åŠ¡æ•°æ®åˆå¹¶å·¥å…·

**åŸºæœ¬ç”¨æ³•:**
```bash
node index.js [--full]
```

**åŠŸèƒ½:**
- è§£æ pfQuest åŸºç¡€ä»»åŠ¡æ•°æ®
- åˆå¹¶ä¹Œé¾Ÿæœè‡ªå®šä¹‰æ•°æ®
- åº”ç”¨åˆ é™¤å’Œè¦†ç›–æ“ä½œ
- ç”Ÿæˆç»Ÿä¸€çš„ä»»åŠ¡IDåˆ—è¡¨

**è¾“å‡ºæ–‡ä»¶:**
- `valid-quest-ids.json` - åŸºç¡€ä»»åŠ¡IDåˆ—è¡¨
- `quest-data-detailed.json` - è¯¦ç»†ç»Ÿè®¡ä¿¡æ¯
- `merged-quest-data.json` - å®Œæ•´åˆå¹¶æ•°æ®ï¼ˆä½¿ç”¨ --fullï¼‰

### ä»»åŠ¡å¥–åŠ±æŠ“å–å·¥å…· (æ¨è)

**åŸºæœ¬ç”¨æ³•:**
```bash
node scrape-quest-rewards-selenium.js [é€‰é¡¹]
```

**ä¸»è¦é€‰é¡¹:**
```bash
--debug [ä»»åŠ¡ID]      # è°ƒè¯•æ¨¡å¼ï¼Œæ˜¾ç¤ºæµè§ˆå™¨ï¼ˆé»˜è®¤ï¼š41188ï¼‰
-c, --count <æ•°é‡>    # å¤„ç†æŒ‡å®šæ•°é‡çš„ä»»åŠ¡
-q, --quests <åˆ—è¡¨>   # å¤„ç†æŒ‡å®šä»»åŠ¡IDï¼ˆé€—å·åˆ†éš”ï¼‰
--headless           # æ— å¤´æ¨¡å¼ï¼ˆåå°è¿è¡Œï¼‰
--show-browser       # æ˜¾ç¤ºæµè§ˆå™¨çª—å£ï¼ˆé»˜è®¤ï¼‰
-d, --delay <æ¯«ç§’>   # è¯·æ±‚é—´éš”ï¼ˆé»˜è®¤ï¼š3000msï¼‰
-o, --output <è·¯å¾„>  # è¾“å‡ºæ–‡ä»¶è·¯å¾„
```

**ä½¿ç”¨ç¤ºä¾‹:**
```bash
# è°ƒè¯•å•ä¸ªä»»åŠ¡
node scrape-quest-rewards-selenium.js --debug

# å¤„ç†æŒ‡å®šä»»åŠ¡
node scrape-quest-rewards-selenium.js -q 41188,41209,50001

# æ— å¤´æ¨¡å¼å¤„ç†50ä¸ªä»»åŠ¡
node scrape-quest-rewards-selenium.js --headless -c 50

# è‡ªå®šä¹‰é—´éš”å’Œè¾“å‡º
node scrape-quest-rewards-selenium.js -d 5000 -o my-rewards.json
```

## ğŸ”§ ç³»ç»Ÿè¦æ±‚

### åŸºç¡€è¦æ±‚
- **Node.js** 12.0 æˆ–æ›´é«˜ç‰ˆæœ¬
- **npm** åŒ…ç®¡ç†å™¨

### Selenium æŠ“å–å·¥å…·é¢å¤–è¦æ±‚
- **Chrome æµè§ˆå™¨** - å¿…é¡»å®‰è£…
- **ChromeDriver** - ä¼šè‡ªåŠ¨ä¸‹è½½ç®¡ç†
- **è¶³å¤Ÿå†…å­˜** - å»ºè®®è‡³å°‘ 4GB RAM

## ğŸ“ è¾“å‡ºæ–‡ä»¶ç»“æ„

### ä»»åŠ¡IDæ–‡ä»¶ (`valid-quest-ids.json`)
```json
{
  "timestamp": "2024-01-01T00:00:00.000Z",
  "validQuestIds": [1, 2, 3, ...],
  "stats": {
    "baseCount": 2847,
    "turtleCount": 245,
    "validCount": 2921,
    "deletedCount": 15,
    "addedCount": 230
  }
}
```

### ä»»åŠ¡å¥–åŠ±æ–‡ä»¶ (`quest-rewards-selenium.json`)
```json
{
  "timestamp": "2024-01-01T00:00:00.000Z",
  "stats": { ... },
  "questRewards": {
    "41188": {
      "questId": 41188,
      "title": "ä»»åŠ¡æ ‡é¢˜",
      "rewardItems": [{"itemId": 25815, "name": "ç‰©å“åç§°", "quantity": 1}],
      "choiceItems": [...],
      "experience": 6600,
      "money": 55000
    }
  },
  "itemDetails": {
    "25815": {
      "itemId": 25815,
      "name": "æ¶é­”å¸ƒé•¿è¢",
      "type": "Armor",
      "subtype": "Cloth",
      "quality": "Uncommon",
      "level": 54,
      "requiredLevel": 49
    }
  }
}
```

## ğŸ¯ NPM è„šæœ¬å¿«æ·æ–¹å¼

| è„šæœ¬ | å‘½ä»¤ | æè¿° |
|------|------|------|
| `npm start` | `node index.js` | æ•°æ®åˆå¹¶å·¥å…· |
| `npm run merge` | `node quest-merger.js` | æ•°æ®åˆå¹¶å·¥å…· |
| `npm run scrape` | é»˜è®¤æŠ“å– | ä½¿ç”¨ Selenium æŠ“å– |
| `npm run scrape-debug` | è°ƒè¯•æ¨¡å¼ | å•ä»»åŠ¡è°ƒè¯• |
| `npm run scrape-sample` | æ ·æœ¬æµ‹è¯• | å¤„ç†5ä¸ªä»»åŠ¡ |
| `npm run scrape-headless` | åå°æ¨¡å¼ | æ— ç•Œé¢å¤„ç†10ä¸ªä»»åŠ¡ |

## ğŸ› VSCode è°ƒè¯•é…ç½®

é¡¹ç›®åŒ…å«å®Œæ•´çš„ VSCode è°ƒè¯•é…ç½®ï¼š

1. **è°ƒè¯•ä»»åŠ¡æ•°æ®åˆå¹¶å™¨** - è°ƒè¯•æ•°æ®åˆå¹¶è¿‡ç¨‹
2. **è°ƒè¯• Selenium ä»»åŠ¡æŠ“å–å™¨** - è°ƒè¯•ä»»åŠ¡å¥–åŠ±æŠ“å–
3. **è°ƒè¯• Selenium æŒ‡å®šä»»åŠ¡** - è°ƒè¯•ç‰¹å®šä»»åŠ¡ID

ä½¿ç”¨æ–¹æ³•ï¼š
1. åœ¨ VSCode ä¸­æ‰“å¼€ `Tools` ç›®å½•
2. æŒ‰ `F5` æˆ–ç‚¹å‡»"è¿è¡Œå’Œè°ƒè¯•"
3. é€‰æ‹©ç›¸åº”çš„è°ƒè¯•é…ç½®

## âš ï¸ æ³¨æ„äº‹é¡¹

### æ•°æ®åˆå¹¶å·¥å…·
- ç¡®ä¿ pfQuest æ•°æ®æ–‡ä»¶å­˜åœ¨
- åˆå¹¶æ“ä½œæ˜¯è¦†ç›–å¼çš„
- åˆ é™¤æ“ä½œä¸å¯é€†

### ä»»åŠ¡å¥–åŠ±æŠ“å–å·¥å…·
- é¦–æ¬¡è¿è¡Œå¯èƒ½éœ€è¦ä¸‹è½½ ChromeDriver
- å»ºè®®å…ˆä½¿ç”¨ `--debug` æ¨¡å¼æµ‹è¯•
- å¤§æ‰¹é‡æŠ“å–è¯·ä½¿ç”¨ `--headless` æ¨¡å¼
- å¯ä»¥éšæ—¶æŒ‰ `Ctrl+C` ä¸­æ–­å¹¶ä¿å­˜è¿›åº¦
- å»ºè®®è®¾ç½®åˆç†çš„è¯·æ±‚é—´éš”é¿å…æœåŠ¡å™¨é™åˆ¶

### æ€§èƒ½å»ºè®®
- **å°è§„æ¨¡æµ‹è¯•**: å…ˆç”¨ `-c 5` æµ‹è¯•
- **ä¸­ç­‰è§„æ¨¡**: ä½¿ç”¨ `-c 50` 
- **å¤§è§„æ¨¡å¤„ç†**: ä½¿ç”¨ `--headless` æ¨¡å¼
- **è°ƒè¯•é—®é¢˜**: ä½¿ç”¨ `--debug` æ¨¡å¼è§‚å¯Ÿ

## ğŸ”„ å·¥ä½œæµç¨‹å»ºè®®

1. **åˆæ¬¡ä½¿ç”¨**:
   ```bash
   npm install              # å®‰è£…ä¾èµ–
   npm start               # ç”Ÿæˆä»»åŠ¡IDåˆ—è¡¨
   npm run scrape-debug    # æµ‹è¯•å•ä¸ªä»»åŠ¡æŠ“å–
   ```

2. **æ—¥å¸¸ä½¿ç”¨**:
   ```bash
   npm run scrape-sample   # å°è§„æ¨¡æµ‹è¯•
   npm run scrape-headless # æ‰¹é‡å¤„ç†
   ```

3. **æ•…éšœæ’é™¤**:
   ```bash
   npm run scrape-debug    # æŸ¥çœ‹è¯¦ç»†è¿‡ç¨‹
   # æ£€æŸ¥æµè§ˆå™¨å’Œç½‘ç»œç¯å¢ƒ
   ```

## ğŸ†˜ å¸¸è§é—®é¢˜

**Q: ChromeDriver ä¸‹è½½å¤±è´¥ï¼Ÿ**
A: æ£€æŸ¥ç½‘ç»œè¿æ¥ï¼Œæˆ–æ‰‹åŠ¨ä¸‹è½½ ChromeDriver å¹¶æ”¾ç½®åœ¨ç³»ç»Ÿ PATH ä¸­

**Q: é¡µé¢åŠ è½½è¶…æ—¶ï¼Ÿ**
A: å¢åŠ  `--delay` å‚æ•°ï¼Œå¦‚ `-d 5000`

**Q: å†…å­˜ä¸è¶³ï¼Ÿ**
A: ä½¿ç”¨ `--headless` æ¨¡å¼ï¼Œæˆ–å‡å°‘å¹¶å‘å¤„ç†æ•°é‡

**Q: æ•°æ®ä¸å®Œæ•´ï¼Ÿ**
A: æ£€æŸ¥ç½‘ç»œè¿æ¥ï¼Œé‡æ–°è¿è¡ŒæŠ“å–å·¥å…·ä¼šè‡ªåŠ¨è·³è¿‡å·²å¤„ç†çš„é¡¹ç›®

## ğŸ“Š æ€§èƒ½å‚è€ƒ

- **æ•°æ®åˆå¹¶**: é€šå¸¸ < 30ç§’
- **å•ä»»åŠ¡æŠ“å–**: 5-10ç§’ï¼ˆåŒ…å«ç‰©å“è¯¦æƒ…ï¼‰
- **100ä»»åŠ¡æ‰¹é‡**: çº¦30-60åˆ†é’Ÿï¼ˆå–å†³äºç½‘ç»œå’Œé—´éš”è®¾ç½®ï¼‰
- **å†…å­˜ä½¿ç”¨**: æµè§ˆå™¨æ¨¡å¼ ~200MBï¼Œæ— å¤´æ¨¡å¼ ~100MB